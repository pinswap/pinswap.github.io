(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["join-fund-pool"],{"082f":function(t,e,s){t.exports=s.p+"img/detail-arrow.d006ac1d.svg"},1308:function(t,e,s){t.exports=s.p+"img/pancanke.bc00dba4.svg"},1500:function(t,e,s){"use strict";s.r(e);var o=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"join-fund-pool"},[o("div",{staticClass:"container-box"},[o("div",{staticClass:"form-container1"},[o("div",{staticClass:"form-container"},[o("div",{staticClass:"liquidity"},[o("span",[t._v(t._s(t.$t("joinFundPool.text15")))]),o("img",{attrs:{src:s("1308")}})]),o("div",{staticClass:"input1"},[o("div",{staticClass:"inputs"},[o("div",{staticClass:"title"},[o("div",{on:{click:function(e){return t.openSearch(0)}}},[o("img",{staticClass:"logo",attrs:{src:t.token0.logoURI}}),o("span",[t._v(t._s(t.token0.symbol))]),o("img",{attrs:{src:s("082f")}})]),o("span",[t._v(t._s(t.balance0.toFixed(6)))])]),o("van-field",{attrs:{type:"number",placeholder:"0.00"},on:{input:t.inputAmount0},model:{value:t.amount0,callback:function(e){t.amount0=e},expression:"amount0"}})],1),t._m(0),o("div",{staticClass:"inputs"},[o("div",{staticClass:"title"},[o("div",{on:{click:function(e){return t.openSearch(1)}}},[o("img",{staticClass:"logo",attrs:{src:t.token1.logoURI}}),o("span",[t._v(t._s(t.token1.symbol))]),o("img",{attrs:{src:s("082f")}})]),o("span",[t._v(t._s(t.balance1.toFixed(6)))])]),o("van-field",{attrs:{type:"number",placeholder:"0.00"},on:{input:t.inputAmount1},model:{value:t.amount1,callback:function(e){t.amount1=e},expression:"amount1"}})],1)]),o("div",{staticClass:"rate"},[o("div",[o("span",{directives:[{name:"show",rawName:"v-show",value:!t.rateChanged,expression:"!rateChanged"}]},[t._v(t._s(t.$t("joinFundPool.text5"))+" 1 "+t._s(t.token0.symbol)+" = "+t._s(t.rate1)+" "+t._s(t.token1.symbol))]),o("span",{directives:[{name:"show",rawName:"v-show",value:t.rateChanged,expression:"rateChanged"}]},[t._v(t._s(t.$t("joinFundPool.text5"))+" 1 "+t._s(t.token1.symbol)+" = "+t._s(t.rate0)+" "+t._s(t.token0.symbol))]),o("img",{attrs:{src:s("1b07")},on:{click:function(e){t.rateChanged=!t.rateChanged}}})]),o("div",{staticClass:"assetspool"},[t._v(t._s(t.$t("mkHeader.text3"))+" $ "+t._s(t.reserveUSD))]),o("span",[t._v(t._s(t.$t("joinFundPool.text6"))+" "+t._s(t.poolProp))])]),o("div",{staticClass:"button"},[o("img",{attrs:{src:s("b012")},on:{click:t.openSetting}}),o("van-button",{attrs:{type:"info",disabled:t.btnDisabled},on:{click:t.addLiquidity}},[t._v(t._s(t.btnText))])],1)])]),o("div",{staticClass:"flowcell"},[t._v(t._s(t.$t("joinFundPool.text17")))]),t.assetsPool?o("div",{staticClass:"your-share1"},[o("div",{staticClass:"your-share"},[o("div",[o("div",{staticClass:"logos"},[o("img",{attrs:{src:t.token0.logoURI}}),o("img",{attrs:{src:t.token1.logoURI}})]),o("div",{staticClass:"lp"},[o("span",[t._v("LP: "+t._s(t.assetsPool.lp.toFixed(6)))]),o("span",[t._v(t._s(t.assetsPool.myShare)+"%")])])]),o("div",[o("div",{staticClass:"info"},[o("span",[t._v(t._s(t.token0.symbol)+"： "+t._s(t.assetsPool.amount0))]),o("span",[t._v(t._s(t.token1.symbol)+"： "+t._s(t.assetsPool.amount1))])]),o("van-button",{attrs:{type:"info"},on:{click:function(e){t.$router.push({path:"/redemption",query:{info:JSON.stringify(t.assetsPool)}})}}},[t._v(t._s(t.$t("joinFundPool.text11")))])],1)])]):t._e()]),o("search-tokens",{ref:"searchTokens",on:{select:t.select}}),o("trading-setup",{ref:"tradingSetup",on:{change:t.changeDeadline}})],1)},n=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"icon-exchange"},[o("div",[o("div",[o("img",{attrs:{src:s("74d7")}})])])])}],i=(s("99af"),s("caad"),s("a9e3"),s("b680"),s("d3b7"),s("2532"),s("96cf"),s("1da1")),a=s("b4e9"),r=s("e549"),c=s("b9cc"),d={components:{"mk-navbar":function(){return Promise.all([s.e("tokenInfo"),s.e("join-fund-pool")]).then(s.bind(null,"0861"))},"search-tokens":function(){return Promise.all([s.e("tokenInfo"),s.e("join-fund-pool")]).then(s.bind(null,"bab4"))},"trading-setup":function(){return Promise.all([s.e("tokenInfo"),s.e("communityManagement~transaction"),s.e("transaction")]).then(s.bind(null,"0430"))}},data:function(){return{token0:a["e"],token1:a["f"],balance0:"0",balance1:"0",allowance0:"0",allowance1:"0",reserve0:"0",reserve1:"0",amount0:"",amount1:"",pairAddress:null,totalLiquidity:"0".toBN(),inputing:!1,rateChanged:!1,reserveUSD:"0",assetsPool:null,slipPoint:2.5,deadline:600,btnState:"none"}},computed:{btnText:function(){return"approving"===this.btnState?this.$t("transaction.text6"):"trading"===this.btnState?this.$t("transaction.text7"):this.allowance0.toBN().lt(this.amount0)?this.$t("HJZCommunity.text9",{token:this.token0.symbol}):this.allowance1.toBN().lt(this.amount1)?this.$t("HJZCommunity.text9",{token:this.token1.symbol}):this.$t("joinFundPool.text7")},btnDisabled:function(){return["approving","trading"].includes(this.btnState)||this.amount0<=0},pairContract:function(){return this.pairAddress?new this.$web3.eth.Contract(r,this.pairAddress):null},rate0:function(){return this.pairAddress?"1".toWei(this.token1.decimals).toBN().times(this.reserve0).div(this.reserve1).toFixed().fromWei(this.token0.decimals).toFixed(6):"--"},rate1:function(){return this.pairAddress?"1".toWei(this.token0.decimals).toBN().times(this.reserve1).div(this.reserve0).toFixed().fromWei(this.token1.decimals).toFixed(6):"--"},poolProp:function(){return Number(this.amount0)<=0||!this.pairAddress?"0%":"".concat(this.amount0.toWei(this.token0.decimals).toBN().div(this.reserve0.toBN().plus(this.amount0.toWei(this.token0.decimals))).times(100).toFixed().toFixed(6),"%")},waitApprove:function(){var t=[];return Number(this.allowance0)<Number(this.amount0)&&this.token0.symbol!==a["c"].symbol&&t.push(this.token0),Number(this.allowance1)<Number(this.amount1)&&this.token1.symbol!==a["c"].symbol&&t.push(this.token1),t}},created:function(){var t=this.$route.query.token?JSON.parse(this.$route.query.token):null;this.$contracts&&this.select(t||a["f"])},methods:{openSearch:function(t){this.$refs.searchTokens.open(t)},openSetting:function(){this.$refs.tradingSetup.open()},switchToken:function(){var t=this.token0;this.token0=this.token1,this.token1=t,this.select(this.token0,0)},inputAmount0:function(){console.log(this.pairAddress),this.pairAddress&&(Number(this.amount0)<=0?this.amount1="":this.amount1=this.amount0.toWei(this.token0.decimals).toBN().times(this.reserve1).div(this.reserve0).toFixed().fromWei(this.token1.decimals).toFixed(6))},inputAmount1:function(){this.pairAddress&&(Number(this.amount1)<=0?this.amount0="":this.amount0=this.amount1.toWei(this.token1.decimals).toBN().times(this.reserve0).div(this.reserve1).toFixed().fromWei(this.token0.decimals).toFixed(6))},approve:function(){var t=this,e=new this.$web3.eth.Contract(c,this.waitApprove[0].address),s=Number(this.waitApprove[0].symbol===this.token1.symbol),o=[this.token0.symbol,this.token1.symbol].includes("AI")?this.$AIRouter._address:this.$Router._address;e.methods.approve(o,this["amount".concat(s)].toWei(this.waitApprove[0].decimals)).send({from:this.$address}).on("transactionHash",(function(e){t.btnState="approving"})).on("receipt",function(){var n=Object(i["a"])(regeneratorRuntime.mark((function n(i){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.methods.allowance(t.$address,o).call({from:t.$address});case 2:t["allowance".concat(s)]=n.sent.fromWei(t.waitApprove[0].decimals),t.btnState="none";case 4:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}()).on("error",(function(e){t.btnState="none",vant.Toast.fail(t.$t("transaction.text13"))}))},addLiquidity:function(){var t=this;if(Number(this.balance0)<Number(this.amount0))return vant.Toast.fail("".concat(this.token0.symbol).concat(this.$t("joinFundPool.text13")));if(Number(this.balance1)<Number(this.amount1))return vant.Toast.fail("".concat(this.token1.symbol).concat(this.$t("joinFundPool.text13")));if(this.waitApprove.length>0)return this.approve();if([this.token0.symbol,this.token1.symbol].includes(a["c"].symbol))return this.addLiquidityETH();var e=this.amount0.toWei(this.token0.decimals),s=this.amount1.toWei(this.token1.decimals),o=e.toBN().div(100).times(this.slipPoint).toFixed(0),n=s.toBN().div(100).times(this.slipPoint).toFixed(0),i=Math.floor((new Date).getTime()/1e3)+this.deadline,r=[this.token0.symbol,this.token1.symbol].includes("AI")?this.$AIRouter:this.$Router;r.methods.addLiquidity(this.token0.address,this.token1.address,e,s,o,n,this.$address,i).send({from:this.$address}).on("transactionHash",(function(e){t.btnState="trading"})).on("receipt",(function(e){vant.Toast.success(t.$t("joinFundPool.text16")),t.btnState="none",t.amount0="",t.amount1="",t.select(t.token1)})).on("error",(function(e){t.btnState="none",vant.Toast.fail(t.$t("transaction.text13"))}))},addLiquidityETH:function(){var t=this,e=Number(this.token0.symbol===a["c"].symbol),s=Number(!(this.token0.symbol===a["c"].symbol)),o=this["amount".concat(e)].toWei(this["token".concat(e)].decimals),n=o.toBN().div(100).times(this.slipPoint).toFixed(0),i=this["amount".concat(s)].toWei(this["token".concat(s)].decimals),r=i.toBN().div(100).times(this.slipPoint).toFixed(0),c=Math.floor((new Date).getTime()/1e3)+this.deadline,d=[this.token0.symbol,this.token1.symbol].includes("AI")?this.$AIRouter:this.$Router;d.methods.addLiquidityETH(this["token".concat(e)].address,o,n,r,this.$address,c).send({from:this.$address,value:i}).on("transactionHash",(function(e){t.btnState="trading"})).on("receipt",(function(e){vant.Toast.success(t.$t("joinFundPool.text16")),t.btnState="none",t.amount0="",t.amount1="",t.select(t.token1)})).on("error",(function(e){t.btnState="none",vant.Toast.fail(t.$t("transaction.text13"))}))},select:function(t){var e=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=this["token".concat(Number(!s))];if(t.symbol===o.symbol)return this.switchToken();this["token".concat(s)]=t;var n=new this.$web3.BatchRequest,i=new this.$web3.eth.Contract(c,this.token0.address),r=new this.$web3.eth.Contract(c,this.token1.address);this.token0.symbol===a["c"].symbol?n.add(this.$web3.eth.getBalance.request(this.$address,"latest")):n.add(i.methods.balanceOf(this.$address).call.request({from:this.$address})),this.token1.symbol===a["c"].symbol?n.add(this.$web3.eth.getBalance.request(this.$address,"latest")):n.add(r.methods.balanceOf(this.$address).call.request({from:this.$address}));var d=[this.token0.symbol,this.token1.symbol].includes("AI")?this.$AIRouter._address:this.$Router._address;n.add(i.methods.allowance(this.$address,d).call.request({from:this.$address})),n.add(r.methods.allowance(this.$address,d).call.request({from:this.$address})),n.add(this.$Factory.methods.getPair(this.token0.address,this.token1.address).call.request({from:this.$address})),n.requestManager.sendBatch(n.requests,(function(t,s){if(t)console.log(s),console.log(t);else{var o=s[4].result.decode(["address"]);if(e.balance0=("string"===typeof s[0]?s[0]:s[0].result).fromWei(e.token0.decimals),e.balance1=s[1].result.fromWei(e.token1.decimals),e.allowance0=s[2].result.toBN().toFixed().fromWei(e.token0.decimals),e.allowance1=s[3].result.toBN().toFixed().fromWei(e.token1.decimals),e.pairAddress=0!==Number(o)?o:null,e.pairContract){var n=new e.$web3.BatchRequest;n.add(e.pairContract.methods.getReserves().call.request({from:e.$address})),n.add(e.pairContract.methods.totalSupply().call.request({from:e.$address})),n.add(e.pairContract.methods.balanceOf(e.$address).call.request({from:e.$address})),n.requestManager.sendBatch(n.requests,(function(t,s){if(!t){var n=("string"===typeof s[0]?s[0]:s[0].result).decode([{type:"uint112",name:"_reserve0"},{type:"uint112",name:"_reserve1"}]),i=n._reserve0,r=n._reserve1,c=e.token0.address.toBN().lt(e.token1.address.toBN()),d=s[2].result.toBN();e.reserve0=c?i:r,e.reserve1=c?r:i,e.totalLiquidity=s[1].result.toBN(),Object(a["i"])(o.toLowerCase()).then((function(t){t&&(e.reserveUSD=Math.floor(t.reserveUSD))})),d.gt(0)?e.assetsPool={logo0:e.token0.logoURI,logo1:e.token1.logoURI,symbol0:e.token0.symbol,symbol1:e.token1.symbol,amount0:d.times(e.reserve0).div(e.totalLiquidity).toFixed(0).fromWei(e.token0.decimals),amount1:d.times(e.reserve1).div(e.totalLiquidity).toFixed(0).fromWei(e.token1.decimals),reserve0:e.reserve0,reserve1:e.reserve1,lp:d.toFixed().fromWei(18),myShare:d.div(e.totalLiquidity).times(100).toFixed().toFixed(6),address0:e.token0.address,address1:e.token1.address,decimals0:e.token0.decimals,decimals1:e.token1.decimals,address:o}:e.pairAddress=null}}))}}}))}}},l=d,u=l,m=(s("da44"),s("2877")),h=Object(m["a"])(u,o,n,!1,null,"7ba9eb58",null);e["default"]=h.exports},"159b":function(t,e,s){var o=s("da84"),n=s("fdbc"),i=s("17c2"),a=s("9112");for(var r in n){var c=o[r],d=c&&c.prototype;if(d&&d.forEach!==i)try{a(d,"forEach",i)}catch(l){d.forEach=i}}},"17c2":function(t,e,s){"use strict";var o=s("b727").forEach,n=s("a640"),i=s("ae40"),a=n("forEach"),r=i("forEach");t.exports=a&&r?[].forEach:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}},"1b07":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAArCAMAAAAniNp/AAACB1BMVEUAAAAAAACAgIBVVVWAgIBmZmZVVVWAgIBgYGBmZmZqampiYmJ2dnZtbW1mZmZ3d3dwcHBpaWl4eHhxcXFra2tzc3NtbW1oaGh0dHRvb29qampwcHBsbGxoaGhxcXFtbW1qampycnJubm5zc3NwcHBsbGxxcXFtbW1xcXFubm5ycnJvb29wcHBra2txcXFxcXFtbW1wcHBra2twcHBubm5sbGxvb29tbW1xcXFtbW1sbGxubm5xcXFvb29wcHBubm5vb29xcXFvb29wcHBwcHBxcXFvb29ubm5wcHBwcHBwcHBvb29ubm5ubm5vb29wcHBvb29wcHBwcHBwcHBxcXFwcHBubm5wcHBvb29wcHBvb29wcHBvb29wcHBvb29wcHBvb29vb29vb29wcHBwcHBxcXFwcHBwcHBvb29wcHBwcHBxcXFwcHBvb29wcHBvb29wcHBvb29vb29vb29vb29wcHBwcHBwcHBwcHBvb29wcHBvb29wcHBvb29wcHBvb29wcHBvb29wcHBvb29wcHBwcHBvb29vb29wcHBwcHBwcHBwcHBvb29wcHBwcHBwcHBwcHBvb29wcHBwcHBwcHBvb29wcHBvb29wcHBwcHBwcHBvb29wcHBwcHBvb29vb29wcHBvb29wcHBwcHBxcXFwcHBwcHBvb29wcHBwcHBvb29wcHBwcHCQV+RjAAAArHRSTlMAAQIDBAUGBggKDA0NDg8PEBEREhMUFRYWFxgZGhsbHB0dHh8gISIjJCUmJykrKy0vMDIyMzQ1NjY4Ozw9PkBDRUZMUlRWV1hZW2Rnb3Z3e3x9gIaKi42Njo+RkpWWl5manJ+foqOkpqipq6ytrrCxsrO1t7i4uru9vsDBwsPExcbHyczMzc7P0NPU2Nra29zd39/h4uXm5+nq7e7w8vP19vf4+fn6+/z8/f7+3+FbNgAAAe9JREFUOMuN02dXE0EUBuDZTSSKWVsMokajYAsiNuyKBUWMil1RYi+IvYuxABbAhopRFIySjBkyO++P9AOHk93N7I7329zznJlz3zmXEEctG8CPxweW6MSr6jKA4D+PzPRC+s6mE2+Hke9d46l8/mDDixGRWk68y2ccpeL1FIUigeMmP6ZCZGIP0lGlqhfYr0SB73hi72jloSJ1GYOazdR97FzoRAchSq1mY0rwpxUOtBeYZTEb+gWQb59vR3EgUjDrPgsO5POPoq5Iq+0zs13AQzbyIOKCtJUfTNocB9ZeZezebDmqeW/SlmAjEJt2jbE75VL0zKQJgzQCMRK6ydhJKXozdMYgo4iEb/06J0WLthhkDJHw1jL5dDopIKK75WRF5P+R5reicXK0atfkAorsmStFX9JnjTE0ryN9WoqSnCaMURR9zrOHpGhBF6ctwTgwJ5Lk9Pwk+XSLX3LavA9Y3c7pxaluEcRe8WwP0MFzl0LuOS3t5hzgudbpXmFW93Ig1xa2tBqAakfgNe84u2E1ZAew2fkttd1tZbbGCoF40eKFS+3n8UO4riuX+gp+VynRJobWgAr57opcU4lKVX3D8OEJPoXaPij+JnfPCPg9B9j2iSOTup+o97yr8kLGFMCfoKcqWX+q8+vA7aL3/gGiXb7ce59HPAAAAABJRU5ErkJggg=="},"3da1":function(t,e,s){},4160:function(t,e,s){"use strict";var o=s("23e7"),n=s("17c2");o({target:"Array",proto:!0,forced:[].forEach!=n},{forEach:n})},"74d7":function(t,e,s){t.exports=s.p+"img/Addlogo.24b359b8.svg"},b012:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADQAAAA0CAMAAADypuvZAAAA7VBMVEUAAABAQEBgYGBqampwcHBmZmZqampxcXFtbW1zc3NwcHBqampvb29sbGxxcXFubm5ycnJwcHBubm5sbGxvb29tbW1wcHBubm5xcXFwcHBubm5tbW1vb29ubm5wcHBvb29xcXFwcHBvb29tbW1vb29ubm5wcHBvb29wcHBvb29ubm5xcXFvb29vb29wcHBwcHBvb29vb29wcHBwcHBvb29wcHBwcHBvb29vb29wcHBwcHBvb29vb29wcHBwcHBvb29vb29wcHBwcHBvb29vb29wcHBwcHBvb29vb29wcHBwcHBvb29vb29wcHBwcHCHo3jSAAAATnRSTlMABAgMEBQYGxwfICQnKCssLzAzNDc4Ozw/QENER0hLTE9QU1RXWFtcYGdob3N3e3+Dh4uPl5ufo6err7O3u7/Dx8vP09fb3+Pn6+/z9/vu9AgEAAADAklEQVQYGZXBi0LaZgCG4e8PkCGsVquzo4cN23Wr46iAJUgggBwCyXv/l7MQzpOofR498Wuld6+t0cPNL3qBdTMAAltrRSDsFvUMqzQj9mAUy0yIjb8oydUYmLcKPehkFDkdQuO6EwL9nI57D345LdkzCNq1uhtC30jZRkiQUYIxAy1lPdbaKUWsgLaStPEVM//0A1h0CorloKYkDr42TC6njRxUlGTMUMeYgLYSfICGjnIJsjrKnhDmddQ1uEYHLn9X5NMU7pTABe9MkvmSU8yMmT50poBjlMB+BEbtro+jWImVsG6UKOWwdqWINcMfzKZePa9n/dYc+ZM+uIrcQEWv1oFzSQPmab3aBTSlN9DSTxjiG1WgoCc+/PBh3DrVExUoqAc9W4fSXVbChtGhywnc6j6Ama196UcI3UbTAxyjfVcLmJcluwue0Z4uuHlF3o+hqj0ZH+7SipgH+Fs7n6BnFLOnBLZ2GlDVih3Q084PwrzWrqGkLWvB0GitTWC05eNqw8zpausCytqoQU5b0NBWn6G2vsJHbdQhqy1oamuAp60/4bM2XBbaGeNpIxXgaOst1LX2JqSjnRZcaa0E37UzZZZSLD2EgnbehoxtxS4XzCztlMAxihQn0Na+BkyLRkqVF/BNe6wR9M6kEdBPaZ9xgHl/EAA1HchPgKYeoGF0yFQDYrNv+h+7C1X9C0U9YZe6Q8/5bumJW7hQNqSjnzBlIqlLmNWrFaEm6Roa1smJXmadnMgjzCrySBhC4Bb1HKvkAQu419JX1tyMEp0+shLkFesHTrXaDuAxrQRnC/Bb1Zob3mkll1bE7oGj46wJNFOK5NM6YDy40FElaOq4c2jpqCEzSwmGDHVMGppK0maqNetd8Y9TreWgpCQdJoplGgsi05KlpRzUlMD4uFq68lkbnWhpgasEfwGdd9LlAoblj5/rM5jYUtGDMK/jcg6RYWUCVaNIyoHu7RQI79JK8t4ldqcV02MpvM/rOedNH+ZprZ0Dk3pWLzGF27K2WtULPfEf9L+5wL6T1UQAAAAASUVORK5CYII="},da44:function(t,e,s){"use strict";s("3da1")},fdbc:function(t,e){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}}}]);